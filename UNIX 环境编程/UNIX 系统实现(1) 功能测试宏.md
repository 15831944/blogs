# 1. 功能测试宏的作用

Linux 系统下的库函数会有不同的标准的版本，例如 POSIX 或者 XOPEN，不同的标准可能定义相同的头文件。当程序被编译时，功能测试宏允许程序员控制编译时系统实际展开哪个标准的头文件的定义。

# 2. 对程序可移植性的影响

当创建可移植程序时：

1. 一些功能测试宏可以用于避免展开非标准定义

2. 另一些宏可以用于展开默认不会展开的非标准定义

# 3. 注意

为使宏定义生效，功能测试宏必须被定义在包含任意头文件以前。

有两种实现方式：

1. 在编译命令行中

2. 在包含任何头文件前使用源代码定义宏

# 4. 举例

若要使 fcntl.h 头文件包含 readahead 函数的声明，则必须定义 _GNU_SOURCE 宏，则使用以下两种方式的任意一种，可避免编译器报函数未声明错误

方式1

```
gcc -D_GNU_SOURCE source.c

```

方式2

```
#define _GNU_SOURCE
#include <fcntl.h>
```
# 5. 参考

man feature_test_macros
