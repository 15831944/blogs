# 管道的作用

管道可以产生两个文件, 进程 A 对文件 fd[1] 写入的内容可以由进程 B 对文件 fd[0] 读取得到

本质上, 管道在内核中开辟了一块缓冲区, 供两个进程用不同的文件描述符分别进行读写

正常来讲, 一个进程打开的文件会产生各自进程的文件描述符表

进程 A 打开一个文件, 进程 B 无法通过文件描述符获取这个文件

而管道建立了这种连接, 并避免了创建一个临时文件

# 管道 pipe

一个管道有两端, 读端 (fd[0]) 和写端 (fd[1])

管道产生的这两个文件(管道描述符)分别供两端的两个进程使用, 写端(标准输出)和读端(标准输入)

fd[0] 是进程为读对管道打开的文件描述符

fd[1] 是进程为写对管道打开的文件描述符

管道在内核中, 管道的两端一般是不同的进程

一个进程的 fd[1] 的输出是另一个进程的 fd[0] 的输入

使用管道命令时, shell 为命令序列中的每条命令单独创建一个进程, 即管道将一个进程的标准输出与一个进程的标准输入相连接

标准输出应可写, 可以作为管道的写端

标准输入应可读, 可以作为管道的读端

管道是半双工的, 数据只能在一个方向上流动, 即数据流方向为 fd[1] 到 fd[0]

管道只能用于具有公共祖先的两个进程之间, 例如在 shell 中输入的命令都属于 shell 的子进程

# 父进程到子进程的管道

父进程的 fd[1] 到子进程的 fd[0]

父进程关闭 fd[0], 此时父进程是写进程, 调用 write 对管道进程写操作

子进程关闭 fd[1], 此时子进程是读进程, 调用 read 对管道进行读操作

写端进程(向其标准输出)写完文件后(产生文件结束符), 由读端进程(从其标准输入)进行读取

# 管道接口

管道创建后, 产生两个文件描述符, 这两个打开的文件供管道两端的进程使用, 其中,

写进程关闭 fd[0], 对 fd[1] 进行写操作

读进程关闭 fd[1], 对 fd[0] 进行读操作

即通过管道, 写进程对 fd[1] 写入的内容可以通过读进程对 fd[0] 读取得到, 从而达到两个进程通信的目的
