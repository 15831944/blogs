# 窗口类样式, 窗口样式

1. 窗口类的设计和注册是由 MFC 底层实现的, 程序不可以去修改其样式, 但可以设计自己的窗口类并注册, 来修改样式
2. 框架类可修改图标样式, 视图类可修改背景颜色, 光标样式

# 工具栏

1. 工具栏按钮的ID号在菜单中有对应的相同ID号的选项
2. 菜单资源和工具栏资源的ID号一样, 使用相同的ID号表示不同的资源

# 状态栏

1. 提示行: 当前鼠标所在位置的操作
2. 状态指示器：大小写, 数字锁, 滚动锁

# 控件样式



# 图形的保存和重绘

1. CView::OnPaint 函数, 响应 WM_PAINT 消息, 进行窗口重绘, 其中调用 CView::OnDraw 函数
2. CScrollView::SetScrollSizes 函数, 设置滚动视图的映射模式, 总尺寸, 点击空白和箭头时水平和垂直滚动数值
3. SetMapMode 函数
4. CDC::SetViewportOrg 函数, 设置视口原点, 如果将视口原点设置为(x, y), 则窗口原点, 即逻辑点(0, 0)就会被映射为设备点(x, y)
5. CDC::SetWindowOrg   函数, 设置窗口原点, 如果将窗口原点设置为(x, y), 则窗口原点, 即逻辑点(x, y)就会被映射为设备点(0, 0), 即客户区的左上角, 且它永远是视口原点(0, 0)
6. CDC::DPtoLP 函数, 设备点转换为逻辑点,
7. CScrollView::OnPrepareDC 会随时根据滚动窗口的位置来调整视口原点

坐标空间和转换

1. 坐标空间和转换: Win32 程序使用坐标空间和转换(Coordinate Spaces and Transformations)对图形输出进行缩放(scale), 旋转(rotate), 平移(translate), 斜切(shear)和反射(reflect)
2. 坐标空间: 是一个平面空间, 通过使用两个相互垂直且长度相等的轴来定位二维对象, 其中, 世界坐标系空间和页面空间称为逻辑空间
3. 各空间之间的转换: 要在物理设备上绘制输出, Windows 把一个矩形区域从一个坐标空间拷贝(映射)到另一个坐标空间, 直至最终完整的输出呈现在物理设备上(通常是屏幕或打印机)
4. 映射的起始空间: 默认从页面空间开始, 可调用 SetWorldTransform 函数, 使映射先从应用程序的世界坐标系空间转换到页面空间
5. 转换算法: 把矩形区域的每一点从一个空间拷贝到另一个空间, 改变被转换对象的大小, 方位, 形态, 转换将对象看成一个整体, 但也可以作用于对象中的每个点或每条线
5. 页面空间中的矩形称为窗口, 设备空间中的矩形被称为视口

坐标空间

1. 世界坐标系空间: 对图形输出进行旋转, 斜切和反射, Y向上
2. 页面空间: 逻辑空间, Y向上
3. 设备空间: Y向下(Positive y-axis Extends)
4. 物理设备空间: 通常指应用程序窗口的客户区, 但也包括桌面, 框架窗口, 打印机, 绘图仪的一页

转换

1. 世界坐标系空间->页面空间: 须调用 SetWorldTransform 函数
2. 页面空间->设备空间(主要), 确定与一特定设备描述表相关的所有图形输出的映射方式, 用的是页面空间和设备空间中两个矩形(窗口和视口)的宽与高的比率(转换因子), 将窗口原点映射到视口原点, 把窗口范围映射到视口范围, 就完成了转换
3. 设备空间->物理空间, 只限于平移, 是由 Windows 窗口管理部分 控制的, 确保设备空间的原点被映射到物理设备上的适当点上, 无法通过函数设置这种转换或获取有关数据

默认转换

1. 一旦应用程序建立了设备描述表, 并立即开始调用GDI绘图或输出函数, 则运用默认页面空间到设备空间的转换和设备空间到物理设备空间(客户区, 桌面, 打印机)的转换
2. 默认页面空间->设备空间, 用视口和窗口的宽与高的比率指定, 默认情况下, 视口尺寸为1*1个像素, 窗口尺寸为1*1页单位
3. 设备空间->物理设备空间, 单位一一对应, 因此只能用于平移,

设备环境属性

1. 设备环境属性控制逻辑坐标到设备坐标的转换

1. 映射方式: 指确定用于绘图操作的单位大小的一种度量转换, 是影响客户区绘图的设备环境属性, 与下面四种属性密切相关
2. 窗口(Window)原点
3. 视口(Viewport)原点
4. 窗口范围
5. 视口范围

坐标转换

1. 逻辑坐标单位: 所有的GDI函数, 使用逻辑坐标, 逻辑坐标可以是像素, 毫米, 英寸等单位, 窗口基于逻辑坐标
2. 设备坐标单位: 所有的消息, 所有的非GDI函数, GetDeviceCaps 函数, 使用设备坐标, 单位就是像素, 视口基于设备坐标, 视口通常和客户区相同

(xViewport - xViewOrg) / xViewExt = (xWindow - XWinOrg) / xWinExt

(视口坐标 - 视口原点) / 视口范围 = (逻辑坐标 - 窗口原点) / 窗口范围

xViewport - xViewOrg = xWindow - XWinOrg (MM_TEXT 映射模式下转换因子为1)

映射模式

1. MM_TEXT, 逻辑单位为像素(和设备单位相同), Y向下, 其他模式都是向上
2. MM_HIMETRIC  0.01 mm
3. MM_TWIPS     1/1440 in
4. MM_HIENGLISH 0.001 in
5. MM_LOMETRIC  0.1 mm
6. MM_LOENGLISH 0.01 in

# 元文件 DC

1. Windows 元文件包含一系列GDI命令, 可以通过重放来创建指定图像或文本

# 兼容 DC
